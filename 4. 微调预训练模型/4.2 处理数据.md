# å¤„ç†æ•°æ®

ç»§ç»­ä¸Šä¸€ç« çš„ä¾‹å­ï¼Œè¿™é‡Œæ˜¯æˆ‘ä»¬å¦‚ä½•åœ¨ PyTorch ä¸­è®­ç»ƒä¸€ä¸ªæ‰¹æ¬¡çš„åºåˆ—åˆ†ç±»å™¨ï¼š 

```python
import torch
from transformers import AdamW, AutoTokenizer, AutoModelForSequenceClassification

# Same as before
checkpoint = "bert-base-uncased"
tokenizer = AutoTokenizer.from_pretrained(checkpoint)
model = AutoModelForSequenceClassification.from_pretrained(checkpoint)
sequences = [
    "I've been waiting for a HuggingFace course my whole life.",
    "This course is amazing!",
]
batch = tokenizer(sequences, padding=True, truncation=True, return_tensors="pt")

# This is new
batch["labels"] = torch.tensor([1, 1])

optimizer = AdamW(model.parameters())
loss = model(**batch).loss
loss.backward()
optimizer.step()
```

å½“ç„¶ï¼Œä»…ä»…åœ¨ä¸¤ä¸ªå¥å­ä¸Šè®­ç»ƒæ¨¡å‹ä¸ä¼šäº§ç”Ÿå¾ˆå¥½çš„ç»“æœã€‚ ä¸ºäº†è·å¾—æ›´å¥½çš„ç»“æœï¼Œæ‚¨éœ€è¦å‡†å¤‡æ›´å¤§çš„æ•°æ®é›†ã€‚ 

åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ William B. Dolan å’Œ Chris Brockett åœ¨ä¸€ç¯‡è®ºæ–‡ä¸­ä»‹ç»çš„ MRPCï¼ˆå¾®è½¯ç ”ç©¶é‡Šä¹‰è¯­æ–™åº“ï¼‰æ•°æ®é›†ä½œä¸ºç¤ºä¾‹ã€‚ è¯¥æ•°æ®é›†ç”± 5,801 å¯¹å¥å­ç»„æˆï¼Œå¸¦æœ‰ä¸€ä¸ªæ ‡ç­¾ï¼Œè¡¨æ˜å®ƒä»¬æ˜¯å¦æ˜¯é‡Šä¹‰ï¼ˆå³ï¼Œä¸¤ä¸ªå¥å­çš„æ„æ€æ˜¯å¦ç›¸åŒï¼‰ã€‚ æˆ‘ä»¬åœ¨æœ¬ç« ä¸­é€‰æ‹©å®ƒæ˜¯å› ä¸ºå®ƒæ˜¯ä¸€ä¸ªå°æ•°æ®é›†ï¼Œå› æ­¤å¾ˆå®¹æ˜“å¯¹å…¶è¿›è¡Œè®­ç»ƒã€‚ 

# ä»Hubä¸­åŠ è½½æ•°æ®é›†

Hub ä¸ä»…åŒ…å«æ¨¡å‹ï¼› å®ƒè¿˜æœ‰è®¸å¤šä¸åŒè¯­è¨€çš„å¤šä¸ªæ•°æ®é›†ã€‚ æ‚¨å¯ä»¥åœ¨[here](https://huggingface.co/datasets)æµè§ˆæ•°æ®é›†ï¼Œæˆ‘ä»¬å»ºè®®æ‚¨åœ¨å®Œæˆæœ¬èŠ‚åå°è¯•åŠ è½½å’Œå¤„ç†æ–°æ•°æ®é›†ï¼ˆè¯·å‚é˜…[here](https://huggingface.co/docs/datasets/loading_datasets.html#from-the-huggingface-hub)çš„ä¸€èˆ¬æ–‡æ¡£ï¼‰ã€‚ ä½†æ˜¯ç°åœ¨ï¼Œè®©æˆ‘ä»¬ä¸“æ³¨äº MRPC æ•°æ®é›†ï¼ è¿™æ˜¯æ„æˆ GLUE åŸºå‡†çš„ 10 ä¸ªæ•°æ®é›†ä¹‹ä¸€ï¼Œè¯¥åŸºå‡†æ˜¯ä¸€ç§å­¦æœ¯åŸºå‡†ï¼Œç”¨äºè¡¡é‡ ML æ¨¡å‹åœ¨ 10 ä¸ªä¸åŒæ–‡æœ¬åˆ†ç±»ä»»åŠ¡ä¸­çš„æ€§èƒ½ã€‚ 

ğŸ¤— æ•°æ®é›†åº“æä¾›äº†ä¸€ä¸ªéå¸¸ç®€å•çš„å‘½ä»¤æ¥ä¸‹è½½å’Œç¼“å­˜Hubä¸Šçš„æ•°æ®é›†ã€‚ æˆ‘ä»¬å¯ä»¥åƒè¿™æ ·ä¸‹è½½ MRPC æ•°æ®é›†ï¼š 

```python
from datasets import load_dataset

raw_datasets = load_dataset("glue", "mrpc")
raw_datasets
DatasetDict({
    train: Dataset({
        features: ['sentence1', 'sentence2', 'label', 'idx'],
        num_rows: 3668
    })
    validation: Dataset({
        features: ['sentence1', 'sentence2', 'label', 'idx'],
        num_rows: 408
    })
    test: Dataset({
        features: ['sentence1', 'sentence2', 'label', 'idx'],
        num_rows: 1725
    })
})
```

å¦‚æ‚¨æ‰€è§ï¼Œæˆ‘ä»¬å¾—åˆ°ä¸€ä¸ª DatasetDict å¯¹è±¡ï¼Œå…¶ä¸­åŒ…å«è®­ç»ƒé›†ã€éªŒè¯é›†å’Œæµ‹è¯•é›†ã€‚ æ¯ä¸€ä¸ªéƒ½åŒ…å«å‡ åˆ—ï¼ˆsentence1ã€sentence2ã€label å’Œ idxï¼‰å’Œå¯å˜æ•°é‡çš„è¡Œï¼Œå®ƒä»¬æ˜¯æ¯ä¸ªé›†åˆä¸­å…ƒç´ çš„æ•°é‡ï¼ˆå› æ­¤ï¼Œè®­ç»ƒé›†ä¸­æœ‰ 3,668 å¯¹å¥å­ï¼ŒéªŒè¯é›†ä¸­æœ‰ 408 å¯¹ é›†ï¼Œæµ‹è¯•é›†ä¸­æœ‰ 1,725 ä¸ªï¼‰ã€‚ 

æ­¤å‘½ä»¤ä¸‹è½½å¹¶ç¼“å­˜æ•°æ®é›†ï¼Œé»˜è®¤åœ¨ ~/.cache/huggingface/dataset ä¸­ã€‚ å›å¿†ç¬¬ 3 ç« ï¼Œæ‚¨å¯ä»¥é€šè¿‡è®¾ç½® HF_HOME ç¯å¢ƒå˜é‡æ¥è‡ªå®šä¹‰ç¼“å­˜æ–‡ä»¶å¤¹ã€‚

æˆ‘ä»¬å¯ä»¥é€šè¿‡ç´¢å¼•æ¥è®¿é—® raw_datasets å¯¹è±¡ä¸­çš„æ¯å¯¹å¥å­ï¼Œå°±åƒä½¿ç”¨å­—å…¸ä¸€æ ·ï¼š 

```python
raw_train_dataset = raw_datasets["train"]
raw_train_dataset[0]
{'idx': 0,
 'label': 1,
 'sentence1': 'Amrozi accused his brother , whom he called " the witness " , of deliberately distorting his evidence .',
 'sentence2': 'Referring to him as only " the witness " , Amrozi accused his brother of deliberate
```

æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ ‡ç­¾å·²ç»æ˜¯æ•´æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸å¿…åœ¨é‚£é‡Œåšä»»ä½•é¢„å¤„ç†ã€‚ è¦çŸ¥é“å“ªä¸ªæ•´æ•°å¯¹åº”å“ªä¸ªæ ‡ç­¾ï¼Œæˆ‘ä»¬å¯ä»¥æ£€æŸ¥ raw_train_dataset çš„ç‰¹å¾ã€‚ è¿™å°†å‘Šè¯‰æˆ‘ä»¬æ¯ä¸€åˆ—çš„ç±»å‹ï¼š

```python
raw_train_dataset.features
{'sentence1': Value(dtype='string', id=None),
 'sentence2': Value(dtype='string', id=None),
 'label': ClassLabel(num_classes=2, names=['not_equivalent', 'equivalent'], names_file=None, id=None),
 'idx': Value(dtype='int32', id=None)}
```

åœ¨å¹•åï¼Œæ ‡ç­¾æ˜¯ ClassLabel ç±»å‹ï¼Œæ•´æ•°åˆ°æ ‡ç­¾åç§°çš„æ˜ å°„å­˜å‚¨åœ¨åç§°æ–‡ä»¶å¤¹ä¸­ã€‚ 0 å¯¹åº” not_equivalentï¼Œ1 å¯¹åº”equivalentã€‚ 

